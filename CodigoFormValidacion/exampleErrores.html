<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <script>

/*
    function parse_json(){ // se provoca  error
        // const my_json = '{\"name\":\"Jhon\", \"age\": 30 }';
        let my_json = '{\"name\":\"Jhon\", \"age\": 30"; ' // con error sintaxis; falta unallave
        let obj = JSON.parse(my_json);
        
        console.log (obj);
        return obj["name"];
    };
//   VM36:1 Uncaught SyntaxError: Expected ',' or '}' after property value in JSON at position 25 (line 1 column 26)

   
    function parse_json(){ 

    try{
        let my_json = '{\"name\":\"Jhon\", \"age\": 30; ' // con error sintaxis
        let obj = JSON.parse(my_json);
        return objet["name"];
    }
        
    catch (error) {
       
        console.log ("error:" + error);
        //error:SyntaxError: Expected ',' or '}' after property value in JSON at position 25 (line 1 column 26)
        return "anonimo";
    }};


    function parse_json(){  // posicion de la variable my_json en padre
        
        let my_json = '{\"name\":\"Jhon\", \"age\": 30';  // con error sintaxis

        try{
            
            let obj = JSON.parse(my_json);
            return objet["name"];
    
        } catch (error) {
            try{
                let other_json = my_json + '}';
                let obj = JSON.parse(other_json);

                console.log (obj);
                return objet["name"];
            } 
            catch (error) {
                console.log ("error:" + error);
                return "anonimo";
            }
            }
        };
    //    age: 30name: "Jhon"[[Prototype]]: Object
    //  exampleErrores.html:61 error:ReferenceError: objet is not defined
    
    
    function parse_json(){  // 
        let my_json = '{\"name\":\"Jhon\", \"age\": 30}';  
        let obj = JSON.parse(my_json);
        return obj["name"];
        }
    
    function procesar_json() {
        console.log ("El usuario es:");
        let name; // la variable esta en el padre para que pueda ser vista por try y por catch
        try{
            name = parse_json();
        } 
        catch (error) {
            console.log ("error:" + error);
            name= "anonimo";
        }
            console.log (name);
        }
        
*/       
    function parse_json(){  // 

            
        let my_json = "{\"name\":\"Jhon\", \"age\": 30}";  
        let obj = JSON.parse(my_json);
        return obj["name"];
        }
            
    function procesar_json() {
        console.log ("El usuario es:");
        let name;
        try{
            db=get_db_connection();
            console.log ("db: " + db);
            name = parse_json();
        }catch (error) {
            console.log ("error:" + error);
            name= "anonimo";
        } finally {
            db=get_db_closed();
            console.log ("db: " + db);
        }
        console.log (name);

    };
    function get_db_connection() { return 1;}
    function get_db_closed() { return 0;}
    // parse_json();
    procesar_json();
</script>    
</body>
</html>